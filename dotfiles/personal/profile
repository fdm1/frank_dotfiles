export LESS=eFRX  # turn off pagination

if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/.tfenv/bin:$PATH"


# VIRTUALENVWRAPPER

export PROJECT_HOME=$HOME/coding
mkdir -p $PROJECT_HOME

if [ ! $(command -v virtualenv) ]; then
  sudo pip install virtualenv
  sudo pip install virtualenvwrapper
fi

export WORKON_HOME=$HOME/coding/.virtualenvs
export VIRTUALENVWRAPPER_PYTHON=$(which python3)
export VIRTUALENVWRAPPER_VIRTUALENV=/usr/local/bin/virtualenv
# export VIRTUALENVWRAPPER_VIRTUALENV_ARGS='--no-site-packages'

source /usr/local/bin/virtualenvwrapper.sh


# Use gpg-agent instead of ssh-agent to use ssh keys and yubikeys
gpg_is_up() {
    echo $(ps aux | grep gpg-agent | grep -v grep | wc -l)
}

export "GPG_TTY=$(tty)"
export "SSH_AUTH_SOCK=${HOME}/.gnupg/S.gpg-agent.ssh"

if [ "$(gpg_is_up)" -eq 0 ]; then
    echo "starting gpg agent"
    eval $(gpg-agent --daemon --enable-ssh-support)
fi

ssh-add -K > /dev/null 2>&1
